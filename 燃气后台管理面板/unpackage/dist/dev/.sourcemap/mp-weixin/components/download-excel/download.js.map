{"version":3,"file":"download.js","sources":["components/download-excel/download.js"],"sourcesContent":["//download.js v4.2, by dandavis; 2008-2016. [MIT] see http://danml.com/download.html for tests/usage\r\n// v1 landed a FF+Chrome compat way of downloading strings to local un-named files, upgraded to use a hidden frame and optional mime\r\n// v2 added named files via a[download], msSaveBlob, IE (10+) support, and window.URL support for larger+faster saves than dataURLs\r\n// v3 added dataURL and Blob Input, bind-toggle arity, and legacy dataURL fallback was improved with force-download mime and base64 support. 3.1 improved safari handling.\r\n// v4 adds AMD/UMD, commonJS, and plain browser support\r\n// v4.1 adds url download capability via solo URL argument (same domain/CORS only)\r\n// v4.2 adds semantic variable names, long (over 2MB) dataURL support, and hidden by default temp anchors\r\n// https://github.com/rndme/download\r\n\r\nexport default function download(data, strFileName, strMimeType) {\r\n\r\n\tlet self = window, // this script is only for browsers anyway...\r\n\t\tdefaultMime = \"application/octet-stream\", // this default mime also triggers iframe downloads\r\n\t\tmimeType = strMimeType || defaultMime,\r\n\t\tpayload = data,\r\n\t\turl = !strFileName && !strMimeType && payload,\r\n\t\tanchor = document.createElement(\"a\"),\r\n\t\ttoString = function(a) { return String(a); },\r\n\t\tmyBlob = (self.Blob || self.MozBlob || self.WebKitBlob || toString),\r\n\t\tfileName = strFileName || \"download\",\r\n\t\tblob,\r\n\t\treader;\r\n\tmyBlob = myBlob.call ? myBlob.bind(self) : Blob;\r\n\r\n\tif (String(this) === \"true\") { //reverse arguments, allowing download.bind(true, \"text/xml\", \"export.xml\") to act as a callback\r\n\t\tpayload = [payload, mimeType];\r\n\t\tmimeType = payload[0];\r\n\t\tpayload = payload[1];\r\n\t}\r\n\r\n\r\n\tif (url && url.length < 2048) { // if no filename and no mime, assume a url was passed as the only argument\r\n\t\tfileName = url.split(\"/\").pop().split(\"?\")[0];\r\n\t\tanchor.href = url; // assign href prop to temp anchor\r\n\t\tif (anchor.href.indexOf(url) !== -1) { // if the browser determines that it's a potentially valid url path:\r\n\t\t\tlet ajax = new XMLHttpRequest();\r\n\t\t\tajax.open(\"GET\", url, true);\r\n\t\t\tajax.responseType = 'blob';\r\n\t\t\tajax.onload = function(e) {\r\n\t\t\t\tdownload(e.target.response, fileName, defaultMime);\r\n\t\t\t};\r\n\t\t\tsetTimeout(function() { ajax.send(); }, 0); // allows setting custom ajax headers using the return:\r\n\t\t\treturn ajax;\r\n\t\t} // end if valid url?\r\n\t} // end if url?\r\n\r\n\r\n\t//go ahead and download dataURLs right away\r\n\tif (/^data:([\\w+-]+\\/[\\w+.-]+)?[,;]/.test(payload)) {\r\n\r\n\t\tif (payload.length > (1024 * 1024 * 1.999) && myBlob !== toString) {\r\n\t\t\tpayload = dataUrlToBlob(payload);\r\n\t\t\tmimeType = payload.type || defaultMime;\r\n\t\t} else {\r\n\t\t\treturn navigator.msSaveBlob ? // IE10 can't do a[download], only Blobs:\r\n\t\t\t\tnavigator.msSaveBlob(dataUrlToBlob(payload), fileName) :\r\n\t\t\t\tsaver(payload); // everyone else can save dataURLs un-processed\r\n\t\t}\r\n\r\n\t} else { //not data url, is it a string with special needs?\r\n\t\tif (/([\\x80-\\xff])/.test(payload)) {\r\n\t\t\tlet i = 0,\r\n\t\t\t\ttempUiArr = new Uint8Array(payload.length),\r\n\t\t\t\tmx = tempUiArr.length;\r\n\t\t\tfor (i; i < mx; ++i) tempUiArr[i] = payload.charCodeAt(i);\r\n\t\t\tpayload = new myBlob([tempUiArr], { type: mimeType });\r\n\t\t}\r\n\t}\r\n\tblob = payload instanceof myBlob ?\r\n\t\tpayload :\r\n\t\tnew myBlob([payload], { type: mimeType });\r\n\r\n\r\n\tfunction dataUrlToBlob(strUrl) {\r\n\t\tlet parts = strUrl.split(/[:;,]/),\r\n\t\t\ttype = parts[1],\r\n\t\t\tdecoder = parts[2] == \"base64\" ? atob : decodeURIComponent,\r\n\t\t\tbinData = decoder(parts.pop()),\r\n\t\t\tmx = binData.length,\r\n\t\t\ti = 0,\r\n\t\t\tuiArr = new Uint8Array(mx);\r\n\r\n\t\tfor (i; i < mx; ++i) uiArr[i] = binData.charCodeAt(i);\r\n\r\n\t\treturn new myBlob([uiArr], { type: type });\r\n\t}\r\n\r\n\tfunction saver(url, winMode) {\r\n\r\n\t\tif ('download' in anchor) { //html5 A[download]\r\n\t\t\tanchor.href = url;\r\n\t\t\tanchor.setAttribute(\"download\", fileName);\r\n\t\t\tanchor.className = \"download-js-link\";\r\n\t\t\tanchor.innerHTML = \"downloading...\";\r\n\t\t\tanchor.style.display = \"none\";\r\n\t\t\tdocument.body.appendChild(anchor);\r\n\t\t\tsetTimeout(function() {\r\n\t\t\t\tanchor.click();\r\n\t\t\t\tdocument.body.removeChild(anchor);\r\n\t\t\t\tif (winMode === true) { setTimeout(function() { self.URL.revokeObjectURL(anchor.href); }, 250); }\r\n\t\t\t}, 66);\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// handle non-a[download] safari as best we can:\r\n\t\tif (/(Version)\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari\\//.test(navigator.userAgent)) {\r\n\t\t\tif (/^data:/.test(url)) url = \"data:\" + url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\r\n\t\t\tif (!window.open(url)) { // popup blocked, offer direct download:\r\n\t\t\t\tif (confirm(\"Displaying New Document\\n\\nUse Save As... to download, then click back to return to this page.\")) { location.href = url; }\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t//do iframe dataURL download (old ch+FF):\r\n\t\tlet f = document.createElement(\"iframe\");\r\n\t\tdocument.body.appendChild(f);\r\n\r\n\t\tif (!winMode && /^data:/.test(url)) { // force a mime that will download:\r\n\t\t\turl = \"data:\" + url.replace(/^data:([\\w\\/\\-\\+]+)/, defaultMime);\r\n\t\t}\r\n\t\tf.src = url;\r\n\t\tsetTimeout(function() { document.body.removeChild(f); }, 333);\r\n\r\n\t} //end saver\r\n\r\n\r\n\r\n\r\n\tif (navigator.msSaveBlob) { // IE10+ : (has Blob, but not a[download] or URL)\r\n\t\treturn navigator.msSaveBlob(blob, fileName);\r\n\t}\r\n\r\n\tif (self.URL) { // simple fast and modern way using Blob and URL:\r\n\t\tsaver(self.URL.createObjectURL(blob), true);\r\n\t} else {\r\n\t\t// handle non-Blob()+non-URL browsers:\r\n\t\tif (typeof blob === \"string\" || blob.constructor === toString) {\r\n\t\t\ttry {\r\n\t\t\t\treturn saver(\"data:\" + mimeType + \";base64,\" + self.btoa(blob));\r\n\t\t\t} catch (y) {\r\n\t\t\t\treturn saver(\"data:\" + mimeType + \",\" + encodeURIComponent(blob));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Blob but not URL support:\r\n\t\treader = new FileReader();\r\n\t\treader.onload = function(e) {\r\n\t\t\tsaver(this.result);\r\n\t\t};\r\n\t\treader.readAsDataURL(blob);\r\n\t}\r\n\treturn true;\r\n}; /* end download() */\r\n"],"names":["url"],"mappings":"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"}