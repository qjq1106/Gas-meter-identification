{"version":3,"file":"util.js","sources":["components/uni-data-menu/util.js"],"sourcesContent":["function buildMenu(menu, menuList, menuIds) {\r\n\tlet nextLayer = []\r\n\tfor (let i = menu.length - 1; i > -1; i--) {\r\n\t\tconst currentMenu = menu[i]\r\n\t\tconst subMenu = menuList.filter(item => {\r\n\t\t\tif (item.parent_id === currentMenu.menu_id) {\r\n\t\t\t\tmenuIds.push(item.menu_id)\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t})\r\n\t\tnextLayer = nextLayer.concat(subMenu)\r\n\t\tcurrentMenu.children = subMenu\r\n\t}\r\n\tif (nextLayer.length) {\r\n\t\tbuildMenu(nextLayer, menuList, menuIds)\r\n\t}\r\n}\r\n\r\nfunction getParentIds(menuItem, menuList) {\r\n\tconst parentArr = []\r\n\tlet currentItem = menuItem\r\n\twhile (currentItem && currentItem.parent_id) {\r\n\t\tparentArr.push(currentItem.parent_id)\r\n\t\tcurrentItem = menuList.find(item => item.menu_id === currentItem.parent_id)\r\n\t}\r\n\treturn parentArr\r\n}\r\n\r\nfunction buildMenus(menuList, trim = true) {\r\n\t// 保证父子级顺序\r\n\tmenuList = menuList.sort(function(a, b) {\r\n\t\tconst parentIdsA = getParentIds(a, menuList)\r\n\t\tconst parentIdsB = getParentIds(b, menuList)\r\n\t\tif (parentIdsA.includes(b.menu_id)) {\r\n\t\t\treturn 1\r\n\t\t}\r\n\t\treturn parentIdsA.length - parentIdsB.length || a.sort - b.sort\r\n\t})\r\n\t// 删除无subMenu且非子节点的菜单项\r\n\tif (trim) {\r\n\t\tfor (let i = menuList.length - 1; i > -1; i--) {\r\n\t\t\tconst currentMenu = menuList[i]\r\n\t\t\tconst subMenu = menuList.filter(subMenuItem => subMenuItem.parent_id === currentMenu.menu_id)\r\n\t\t\tif (!currentMenu.isLeafNode && !subMenu.length) {\r\n\t\t\t\tmenuList.splice(i, 1)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tconst menuIds = []\r\n\tconst menu = menuList.filter(item => {\r\n\t\tif (!item.parent_id) {\r\n\t\t\tmenuIds.push(item.menu_id)\r\n\t\t\treturn true\r\n\t\t}\r\n\t})\r\n\tbuildMenu(menu, menuList, menuIds)\r\n\t// 包含所有无效菜单\r\n\tif (!trim && menuIds.length !== menuList.length) {\r\n\t\tmenu.push(...menuList.filter(item => !menuIds.includes(item.menu_id)))\r\n\t}\r\n\treturn menu\r\n}\r\n\r\nexport {\r\n\tbuildMenu,\r\n\tbuildMenus\r\n}\n"],"names":[],"mappings":";AAAA,SAAS,UAAU,MAAM,UAAU,SAAS;AAC3C,MAAI,YAAY,CAAE;AAClB,WAAS,IAAI,KAAK,SAAS,GAAG,IAAI,IAAI,KAAK;AAC1C,UAAM,cAAc,KAAK,CAAC;AAC1B,UAAM,UAAU,SAAS,OAAO,UAAQ;AACvC,UAAI,KAAK,cAAc,YAAY,SAAS;AAC3C,gBAAQ,KAAK,KAAK,OAAO;AACzB,eAAO;AAAA,MACP;AAAA,IACJ,CAAG;AACD,gBAAY,UAAU,OAAO,OAAO;AACpC,gBAAY,WAAW;AAAA,EACvB;AACD,MAAI,UAAU,QAAQ;AACrB,cAAU,WAAW,UAAU,OAAO;AAAA,EACtC;AACF;AAEA,SAAS,aAAa,UAAU,UAAU;AACzC,QAAM,YAAY,CAAE;AACpB,MAAI,cAAc;AAClB,SAAO,eAAe,YAAY,WAAW;AAC5C,cAAU,KAAK,YAAY,SAAS;AACpC,kBAAc,SAAS,KAAK,UAAQ,KAAK,YAAY,YAAY,SAAS;AAAA,EAC1E;AACD,SAAO;AACR;AAEA,SAAS,WAAW,UAAU,OAAO,MAAM;AAE1C,aAAW,SAAS,KAAK,SAAS,GAAG,GAAG;AACvC,UAAM,aAAa,aAAa,GAAG,QAAQ;AAC3C,UAAM,aAAa,aAAa,GAAG,QAAQ;AAC3C,QAAI,WAAW,SAAS,EAAE,OAAO,GAAG;AACnC,aAAO;AAAA,IACP;AACD,WAAO,WAAW,SAAS,WAAW,UAAU,EAAE,OAAO,EAAE;AAAA,EAC7D,CAAE;AAED,MAAI,MAAM;AACT,aAAS,IAAI,SAAS,SAAS,GAAG,IAAI,IAAI,KAAK;AAC9C,YAAM,cAAc,SAAS,CAAC;AAC9B,YAAM,UAAU,SAAS,OAAO,iBAAe,YAAY,cAAc,YAAY,OAAO;AAC5F,UAAI,CAAC,YAAY,cAAc,CAAC,QAAQ,QAAQ;AAC/C,iBAAS,OAAO,GAAG,CAAC;AAAA,MACpB;AAAA,IACD;AAAA,EACD;AACD,QAAM,UAAU,CAAE;AAClB,QAAM,OAAO,SAAS,OAAO,UAAQ;AACpC,QAAI,CAAC,KAAK,WAAW;AACpB,cAAQ,KAAK,KAAK,OAAO;AACzB,aAAO;AAAA,IACP;AAAA,EACH,CAAE;AACD,YAAU,MAAM,UAAU,OAAO;AAEjC,MAAI,CAAC,QAAQ,QAAQ,WAAW,SAAS,QAAQ;AAChD,SAAK,KAAK,GAAG,SAAS,OAAO,UAAQ,CAAC,QAAQ,SAAS,KAAK,OAAO,CAAC,CAAC;AAAA,EACrE;AACD,SAAO;AACR;;"}