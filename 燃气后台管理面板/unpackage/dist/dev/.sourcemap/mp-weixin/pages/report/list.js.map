{"version":3,"file":"list.js","sources":["pages/report/list.vue","../../../../微信开发者工具/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvcmVwb3J0L2xpc3QudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"uni-container\">\r\n\t\t<uni-table ref=\"table\" :loading=\"loading\" border stripe emptyText=\"暂无更多数据\" type=\"selection\"\r\n\t\t\t@selection-change=\"selectionChange\">\r\n\t\t\t<uni-tr>\r\n\t\t\t\t<uni-th width=\"150\" align=\"center\">识别读数</uni-th>\r\n\t\t\t\t<uni-th width=\"150\" align=\"center\">地址</uni-th>\r\n\t\t\t\t<uni-th width=\"120\" align=\"center\">楼栋</uni-th>\r\n\t\t\t\t<uni-th width=\"120\" align=\"center\">抄表日期</uni-th>\r\n\t\t\t\t<uni-th width=\"100\" align=\"center\">状态</uni-th>\r\n\t\t\t\t<uni-th width=\"150\" align=\"center\">更新时间</uni-th>\r\n\t\t\t\t<uni-th width=\"200\" align=\"center\">操作</uni-th>\r\n\t\t\t</uni-tr>\r\n\t\t\t<uni-tr v-for=\"(item, index) in tableData\" :key=\"index\">\r\n\t\t\t\t<uni-td>{{ item.reading }}</uni-td>\r\n\t\t\t\t<uni-td>{{ item.address }}</uni-td>\r\n\t\t\t\t<uni-td>{{ item.building || '-' }}</uni-td>\r\n\t\t\t\t<uni-td>{{ item.date }}</uni-td>\r\n\t\t\t\t<uni-td>\r\n\t\t\t\t\t<uni-tag :text=\"item.status\" :type=\"getStatusType(item.status)\" />\r\n\t\t\t\t</uni-td>\r\n\t\t\t\t<uni-td>{{ formatTime(item.updateTime) }}</uni-td>\r\n\t\t\t\t<uni-td>\r\n\t\t\t\t\t<view class=\"uni-group\">\r\n\t\t\t\t\t\t<button class=\"uni-button uni-button--default\" size=\"mini\" @click=\"navigateTo('./edit?id=' + item._id)\">修改</button>\r\n\t\t\t\t\t\t<button class=\"uni-button uni-button--primary\" size=\"mini\" @click=\"navigateTo('./detail?id=' + item._id)\">详情</button>\r\n\t\t\t\t\t\t<button class=\"uni-button uni-button--danger\" size=\"mini\" @click=\"confirmDelete(item._id)\">删除</button>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</uni-td>\r\n\t\t\t</uni-tr>\r\n\t\t</uni-table>\r\n\t\t<view class=\"uni-pagination-box\">\r\n\t\t\t<uni-pagination show-icon :page-size=\"options.pageSize\" :current=\"options.pageCurrent\"\r\n\t\t\t\t:total=\"options.total\" @change=\"change\" />\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport { \r\n\tcollection, \r\n\tenumConverter \r\n} from '@/js_sdk/validator/report'\r\n\r\nconst db = uniCloud.database()\r\nconst dbCmd = db.command\r\nconst dbCollectionName = 'report'\r\n\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tloading: false,\r\n\t\t\twhere: '',\r\n\t\t\ttableData: [],\r\n\t\t\tselectedIndexs: [],\r\n\t\t\toptions: {\r\n\t\t\t\tpageCurrent: 1,\r\n\t\t\t\tpageSize: 20,\r\n\t\t\t\ttotal: 0\r\n\t\t\t},\r\n\t\t\timageStyles: {\r\n\t\t\t\twidth: 64,\r\n\t\t\t\theight: 64\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\tthis.getCloudDataList()\r\n\t},\r\n\tonReachBottom() {\r\n\t\tthis.loadMore()\r\n\t},\r\n\tmethods: {\r\n\t\tasync getCloudDataList() {\r\n\t\t\tif (this.loading) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tthis.loading = true\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await db.collection(dbCollectionName)\r\n\t\t\t\t\t.orderBy('updateTime', 'desc')\r\n\t\t\t\t\t.skip((this.options.pageCurrent - 1) * this.options.pageSize)\r\n\t\t\t\t\t.limit(this.options.pageSize)\r\n\t\t\t\t\t.get()\r\n\t\t\t\t\r\n\t\t\t\tthis.tableData = res.data.data || []\r\n\t\t\t\tthis.options.total = res.data.affectedDocs || 0\r\n\t\t\t\t\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.$u.toast('获取数据失败')\r\n\t\t\t\tconsole.error(err)\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t}\r\n\t\t},\r\n\t\tloadMore() {\r\n\t\t\tif (this.options.pageCurrent * this.options.pageSize < this.options.total) {\r\n\t\t\t\tthis.options.pageCurrent++\r\n\t\t\t\tthis.getCloudDataList()\r\n\t\t\t}\r\n\t\t},\r\n\t\tchange(e) {\r\n\t\t\tthis.options.pageCurrent = e.current\r\n\t\t\tthis.getCloudDataList()\r\n\t\t},\r\n\t\tselectionChange(e) {\r\n\t\t\tthis.selectedIndexs = e.detail.index\r\n\t\t},\r\n\t\tconfirmDelete(id) {\r\n\t\t\tuni.showModal({\r\n\t\t\t\tcontent: '是否删除该条记录？',\r\n\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\tawait this.deleteRecord(id)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tasync deleteRecord(id) {\r\n\t\t\ttry {\r\n\t\t\t\tconst res = await db.collection(dbCollectionName).doc(id).remove()\r\n\t\t\t\tif (res.data.deleted > 0) {\r\n\t\t\t\t\tuni.$u.toast('删除成功')\r\n\t\t\t\t\tthis.getCloudDataList()\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tuni.$u.toast('删除失败')\r\n\t\t\t\tconsole.error(err)\r\n\t\t\t}\r\n\t\t},\r\n\t\tnavigateTo(url) {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl\r\n\t\t\t})\r\n\t\t},\r\n\t\tgetStatusType(status) {\r\n\t\t\tconst statusMap = {\r\n\t\t\t\t'已识别': 'primary',\r\n\t\t\t\t'已确认': 'success', \r\n\t\t\t\t'待审核': 'warning',\r\n\t\t\t\t'异常': 'error'\r\n\t\t\t}\r\n\t\t\treturn statusMap[status] || 'default'\r\n\t\t},\r\n\t\tformatTime(timestamp) {\r\n\t\t\tif (!timestamp) return '-'\r\n\t\t\tconst date = new Date(timestamp)\r\n\t\t\treturn `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')} ${String(date.getHours()).padStart(2, '0')}:${String(date.getMinutes()).padStart(2, '0')}`\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style>\r\n.uni-container {\r\n\tpadding: 15px;\r\n}\r\n\r\n.uni-group {\r\n\tdisplay: flex;\r\n\tgap: 5px;\r\n}\r\n\r\n.uni-pagination-box {\r\n\tmargin-top: 15px;\r\n\tdisplay: flex;\r\n\tjustify-content: center;\r\n}\r\n</style>","import MiniProgramPage from 'E:/testProjects/WeChatProjects/testProject-2/燃气后台管理面板/pages/report/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["uniCloud","uni"],"mappings":"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"}