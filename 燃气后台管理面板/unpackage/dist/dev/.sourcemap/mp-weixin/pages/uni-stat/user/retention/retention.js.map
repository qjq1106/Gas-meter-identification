{"version":3,"file":"retention.js","sources":["pages/uni-stat/user/retention/retention.vue","../../../../微信开发者工具/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNcdW5pLXN0YXRcdXNlclxyZXRlbnRpb25ccmV0ZW50aW9uLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<!-- 对应页面：注册用户统计-留存  -->\r\n\t<view class=\"fix-top-window\">\r\n\t\t<view class=\"uni-header\">\r\n\t\t\t<uni-stat-breadcrumb class=\"uni-stat-breadcrumb-on-phone\" />\r\n\t\t\t<view class=\"uni-group\">\r\n\t\t\t\t<view class=\"uni-sub-title hide-on-phone\">用户留存趋势分析</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"uni-container\">\r\n\t\t\t<view class=\"uni-stat--x flex p-1015\">\n\t\t\t\t<view class=\"uni-stat--app-select\">\n\t\t\t\t\t<uni-data-select collection=\"opendb-app-list\" field=\"appid as value, name as text\" orderby=\"text asc\" :defItem=\"1\" label=\"应用选择\" @change=\"changeAppid\" v-model=\"query.appid\" :clear=\"false\" />\r\n\t\t\t\t\t<uni-data-select collection=\"opendb-app-versions\" :where=\"versionQuery\" class=\"ml-m\" field=\"_id as value, version as text, uni_platform as label, create_date as date\" format=\"{label} - {text}\" orderby=\"date desc\" label=\"版本选择\" v-model=\"query.version_id\" />\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"uni-stat--x flex\">\r\n\t\t\t\t<uni-stat-tabs label=\"日期选择\" :current=\"currentDateTab\" mode=\"date\" :yesterday=\"false\" @change=\"changeTimeRange\" />\r\n\t\t\t\t<uni-datetime-picker type=\"datetimerange\" :end=\"new Date().getTime()\" v-model=\"query.start_time\"\r\n\t\t\t\t\treturnType=\"timestamp\" :clearIcon=\"false\" class=\"uni-stat-datetime-picker\"\r\n\t\t\t\t\t:class=\"{'uni-stat__actived': currentDateTab < 0 && !!query.start_time.length}\"\r\n\t\t\t\t\t@change=\"useDatetimePicker\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"uni-stat--x\">\r\n\t\t\t\t<uni-stat-tabs label=\"平台选择\" type=\"boldLine\" mode=\"platform\" v-model=\"query.platform_id\" @change=\"changePlatform\" />\r\n\t\t\t\t<uni-data-select ref=\"version-select\" v-if=\"query.platform_id && query.platform_id.indexOf('==') === -1\" collection=\"uni-stat-app-channels\" :where=\"channelQuery\" class=\"p-channel\" field=\"_id as value, channel_name as text\" orderby=\"text asc\" label=\"渠道/场景值选择\" v-model=\"query.channel_id\" />\r\n\t\t\t</view>\r\n\t\t\t<view class=\"uni-stat--x mb-m\" style=\"padding-top: 0;\">\r\n\t\t\t\t<view class=\"mb-m line-bottom\">\r\n\t\t\t\t\t<uni-stat-tabs type=\"boldLine\" :tabs=\"fields\" v-model=\"field\" tooltip\r\n\t\t\t\t\t\tstyle=\"line-height: 40px; margin-bottom: -17px;\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<uni-stat-tabs type=\"box\" :tabs=\"keys\" v-model=\"key\" class=\"mb-l\" />\r\n\t\t\t\t<view class=\"p-m\">\r\n\t\t\t\t\t<view class=\"uni-charts-box\">\r\n\t\t\t\t\t\t<qiun-data-charts type=\"area\" :chartData=\"chartData\" echartsH5 echartsApp :errorMessage=\"errorMessage\"/>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"uni-stat--x p-m\">\r\n\t\t\t\t<view class=\"uni-tips mb-s flex\">\r\n\t\t\t\t\t<uni-icons type=\"info\"></uni-icons>\r\n\t\t\t\t\t表格中显示为空，表示留存为 0 或无数据\r\n\t\t\t\t</view>\r\n\t\t\t\t<uni-table :loading=\"loading\" stripe :emptyText=\"errorMessage || $t('common.empty')\">\r\n\t\t\t\t\t<uni-tr style=\"background-color: #eee;\">\r\n\t\t\t\t\t\t<block v-for=\"(mapper, index) in fieldsMap\" :key=\"index\">\r\n\t\t\t\t\t\t\t<uni-th v-if=\"mapper.title\" :key=\"index\" align=\"center\">{{mapper.title}}</uni-th>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t</uni-tr>\r\n\t\t\t\t\t<uni-tr v-for=\"(item ,i) in tableData\" :key=\"i\">\r\n\t\t\t\t\t\t<block v-for=\"(mapper, index) in fieldsMap\" :key=\"index\">\r\n\t\t\t\t\t\t\t<uni-td v-if=\"mapper.title\" :key=\"index\" align=\"center\"\r\n\t\t\t\t\t\t\t\t:class=\"/[d|w|m]_\\d/.test(mapper.field)&&[item[mapper.field] ? 'uni-stat-table-bg' : '']\">\r\n\t\t\t\t\t\t\t\t{{item[mapper.field] ? item[mapper.field] : ''}}\r\n\t\t\t\t\t\t\t</uni-td>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t</uni-tr>\r\n\t\t\t\t</uni-table>\r\n\t\t\t\t<view class=\"uni-pagination-box\">\r\n\t\t\t\t\t<uni-pagination show-icon show-page-size :page-size=\"options.pageSize\"\r\n\t\t\t\t\t\t:current=\"options.pageCurrent\" :total=\"options.total\" @change=\"changePageCurrent\"\r\n\t\t\t\t\t\t@pageSizeChange=\"changePageSize\" />\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- #ifndef H5 -->\r\n\t\t<fix-window />\r\n\t\t<!-- #endif -->\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tmapfields,\r\n\t\tstringifyQuery,\r\n\t\tstringifyField,\r\n\t\tstringifyGroupField,\r\n\t\tgetTimeOfSomeDayAgo,\r\n\t\tdivision,\r\n\t\tformat,\r\n\t\tformatDate,\r\n\t\tdebounce\r\n\t} from '@/js_sdk/uni-stat/util.js'\r\n\timport fieldsFactory from './fieldsMap.js'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tquery: {\r\n\t\t\t\t\tdimension: \"day\",\r\n\t\t\t\t\tappid: '',\r\n\t\t\t\t\tplatform_id: '',\r\n\t\t\t\t\tuni_platform: '',\r\n\t\t\t\t\tversion_id: '',\r\n\t\t\t\t\tchannel_id: '',\r\n\t\t\t\t\tstart_time: [],\r\n\t\t\t\t},\r\n\t\t\t\toptions: {\r\n\t\t\t\t\tpageSize: 20,\r\n\t\t\t\t\tpageCurrent: 1, // 当前页\r\n\t\t\t\t\ttotal: 0, // 数据总量\r\n\t\t\t\t},\r\n\t\t\t\tloading: false,\r\n\t\t\t\tcurrentDateTab: 0,\r\n\t\t\t\ttableData: [],\r\n\t\t\t\tchartData: {},\r\n\t\t\t\tfield: 'new_user',\r\n\t\t\t\tfields: [{\r\n\t\t\t\t\t_id: 'new_user',\r\n\t\t\t\t\tname: '新增留存',\r\n\t\t\t\t\ttooltip: '指定时间新增（即首次访问应用）用户，在之后的第N天，再次访问应用的用户数占比'\r\n\t\t\t\t}, {\r\n\t\t\t\t\t_id: 'active_user',\r\n\t\t\t\t\tname: '活跃留存',\r\n\t\t\t\t\ttooltip: '指定时间活跃（即访问应用）用户，在之后的第N天，再次访问应用的用户数占比'\r\n\t\t\t\t}],\r\n\t\t\t\tkey: 1,\r\n\t\t\t\tchannelData: [],\r\n\t\t\t\terrorMessage: \"\",\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tfieldsMap() {\r\n\t\t\t\tconst title = this.field === 'active_user' ? '活跃用户' : '新增用户'\r\n\t\t\t\tconst maps = [{\r\n\t\t\t\t\ttitle,\r\n\t\t\t\t\tfield: `${this.field}_count`,\r\n\t\t\t\t\tstat: 0\r\n\t\t\t\t}]\r\n\t\t\t\treturn fieldsFactory(maps)\r\n\t\t\t},\r\n\t\t\tfieldName() {\r\n\t\t\t\tlet name = ''\r\n\t\t\t\tthis.fields.forEach(item => {\r\n\t\t\t\t\tif (item._id === this.field) {\r\n\t\t\t\t\t\tname = item.name\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\treturn name\r\n\t\t\t},\r\n\t\t\tkeyName() {\r\n\t\t\t\treturn this.keys.forEach(item => {\r\n\t\t\t\t\tif (item._id === this.key) {\r\n\t\t\t\t\t\treturn item.name\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tkeys() {\r\n\t\t\t\tconst values = [1, 2, 3, 4, 5, 6, 7, 14, 30]\r\n\t\t\t\treturn values.map(val => {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t_id: val,\r\n\t\t\t\t\t\tname: `${val}天后`\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tchannelQuery() {\r\n\t\t\t\tconst platform_id = this.query.platform_id\r\n\t\t\t\treturn stringifyQuery({\r\n\t\t\t\t\tplatform_id\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tversionQuery() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tappid,\r\n\t\t\t\t\tuni_platform\r\n\t\t\t\t} = this.query\r\n\t\t\t\tconst query = stringifyQuery({\r\n\t\t\t\t\tappid,\r\n\t\t\t\t\tuni_platform\r\n\t\t\t\t})\r\n\t\t\t\treturn query\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.debounceGet = debounce(() => {\r\n\t\t\t\tthis.getAllData(this.query);\r\n\t\t\t}, 300);\r\n\t\t\tthis.getChannelData()\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tquery: {\r\n\t\t\t\tdeep: true,\r\n\t\t\t\thandler(val) {\r\n\t\t\t\t\tthis.options.pageCurrent = 1 // 重置分页\r\n\t\t\t\t\tthis.debounceGet()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tkey() {\r\n\t\t\t\tthis.debounceGet()\r\n\t\t\t},\r\n\t\t\tfield() {\r\n\t\t\t\tthis.debounceGet()\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tuseDatetimePicker() {\r\n\t\t\t\tthis.currentDateTab = -1\r\n\t\t\t},\r\n\t\t\tchangeAppid(id) {\r\n\t\t\t\tthis.getChannelData(id, false)\r\n\t\t\t},\r\n\t\t\tchangePlatform(id, index, name, item) {\r\n\t\t\t\tthis.getChannelData(null, id)\r\n\t\t\t\tthis.query.version_id = 0\r\n\t\t\t\tthis.query.uni_platform = item.code\r\n\t\t\t},\r\n\t\t\tchangeTimeRange(id, index) {\r\n\t\t\t\tthis.currentDateTab = index\r\n\t\t\t\tconst start = getTimeOfSomeDayAgo(id),\r\n\t\t\t\t\tend = getTimeOfSomeDayAgo(0) - 1\r\n\t\t\t\tthis.query.start_time = [start, end]\r\n\t\t\t},\r\n\r\n\t\t\tchangePageCurrent(e) {\r\n\t\t\t\tthis.options.pageCurrent = e.current\r\n\t\t\t\tthis.getTabelData(this.query)\r\n\t\t\t},\r\n\r\n\t\t\tchangePageSize(pageSize) {\r\n\t\t\t\tthis.options.pageSize = pageSize\r\n\t\t\t\tthis.options.pageCurrent = 1 // 重置分页\r\n\t\t\t\tthis.getTabelData(this.query)\r\n\t\t\t},\r\n\r\n\t\t\t// 此处 util 中的 stringifyField 不满足需求，特殊处理 stringifyField\r\n\t\t\tstringifyField(mapping, goal, prop) {\r\n\t\t\t\tif (goal) {\r\n\t\t\t\t\tmapping = mapping.filter(f => f.field === goal)\r\n\t\t\t\t}\r\n\t\t\t\tif (prop) {\r\n\t\t\t\t\tmapping = mapping.filter(f => f.field && f.hasOwnProperty(prop))\r\n\t\t\t\t}\r\n\t\t\t\tconst fields = mapping.map(f => {\r\n\t\t\t\t\tif (f.stat === -1) {\r\n\t\t\t\t\t\treturn f.field\r\n\t\t\t\t\t} else if (f.stat === 0) {\r\n\t\t\t\t\t\treturn `${f.field} as ${ 'temp_' + f.field}`\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn `retention.${this.field}.${f.field}.user_count as ${ 'temp_' + f.field}`\r\n\t\t\t\t\t}\r\n\t\t\t\t}).join()\r\n\t\t\t\treturn fields\r\n\t\t\t},\r\n\r\n\t\t\t// 此处 util 中的 groupField 不满足需求，特殊处理 groupField\r\n\t\t\tcreateStr(type = \"user_count\", vals, fields, tail) {\r\n\t\t\t\tconst value = vals || [1, 2, 3, 4, 5, 6, 7, 14, 30]\r\n\t\t\t\tconst p = 'd'\r\n\t\t\t\tconst f = this.fields.map(item => item._id)\r\n\t\t\t\tfields = fields || f\r\n\t\t\t\tconst strArr = value.map(item => {\r\n\t\t\t\t\treturn fields.map(field => {\r\n\t\t\t\t\t\treturn `retention.${field}.${p + '_' + item}.${type} as ${p + '_' + item}`\r\n\t\t\t\t\t})\r\n\t\t\t\t})\r\n\t\t\t\tif (tail) {\r\n\t\t\t\t\tstrArr.push(tail)\r\n\t\t\t\t}\r\n\t\t\t\tconst str = strArr.join()\r\n\t\t\t\treturn str\r\n\t\t\t},\r\n\r\n\t\t\tgetAllData(query) {\r\n\t\t\t\tif (!query.appid) {\r\n\t\t\t\t\tthis.errorMessage = \"请先选择应用\";\r\n\t\t\t\t\treturn; // 如果appid为空，则不进行查询\r\n\t\t\t\t}\r\n\t\t\t\tthis.errorMessage = \"\";\r\n\t\t\t\tthis.getChartData(query, this.key, this.keyName)\r\n\t\t\t\tthis.getTabelData(query)\r\n\t\t\t},\r\n\r\n\t\t\tgetChartData(query, key = this.key, name = '访问人数') {\r\n\t\t\t\t// this.chartData = {}\r\n\t\t\t\tconst {\r\n\t\t\t\t\tpageCurrent\r\n\t\t\t\t} = this.options\r\n\t\t\t\tquery = stringifyQuery(query, null, ['uni_platform'])\r\n\t\t\t\tconst groupField = this.createStr(\"user_count\", [key], [this.field])\r\n\t\t\t\tconst db = uniCloud.database()\r\n\t\t\t\tdb.collection('uni-stat-result')\r\n\t\t\t\t\t.where(query)\r\n\t\t\t\t\t.field(`${this.stringifyField(this.fieldsMap, `d_${key}`)}, start_time`)\r\n\t\t\t\t\t.groupBy('start_time')\r\n\t\t\t\t\t.groupField(stringifyGroupField(this.fieldsMap, `d_${key}`))\r\n\t\t\t\t\t.orderBy('start_time', 'asc')\r\n\t\t\t\t\t.get({\r\n\t\t\t\t\t\tgetCount: true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tlet {\r\n\t\t\t\t\t\t\tcount,\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = res.result\r\n\t\t\t\t\t\tconst options = {\r\n\t\t\t\t\t\t\tcategories: [],\r\n\t\t\t\t\t\t\tseries: [{\r\n\t\t\t\t\t\t\t\tname: `${key}天后${this.fieldName}`,\r\n\t\t\t\t\t\t\t\tdata: []\r\n\t\t\t\t\t\t\t}]\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (const item of data) {\r\n\t\t\t\t\t\t\tconst x = formatDate(item.start_time, 'day')\r\n\t\t\t\t\t\t\tconst y = item[`d_${key}`]\r\n\t\t\t\t\t\t\toptions.series[0].data.push(y)\r\n\t\t\t\t\t\t\toptions.categories.push(x)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.chartData = options\r\n\t\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t\t\t// err.message 错误信息\r\n\t\t\t\t\t\t// err.code 错误码\r\n\t\t\t\t\t}).finally(() => {\r\n\t\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\r\n\t\t\tgetTabelData(query) {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tpageCurrent\r\n\t\t\t\t} = this.options\r\n\t\t\t\tquery = stringifyQuery(query, null, ['uni_platform'])\r\n\t\t\t\tconst tail = this.field + \"_count\"\r\n\t\t\t\tconst groupField = this.createStr('user_rate', '', [this.field], tail)\r\n\t\t\t\tthis.loading = true\r\n\t\t\t\tconst db = uniCloud.database()\r\n\t\t\t\tdb.collection('uni-stat-result')\r\n\t\t\t\t\t.where(query)\r\n\t\t\t\t\t.field(this.stringifyField(this.fieldsMap))\r\n\t\t\t\t\t.groupBy('start_time')\r\n\t\t\t\t\t.groupField(stringifyGroupField(this.fieldsMap))\r\n\t\t\t\t\t.orderBy('start_time', 'desc')\r\n\t\t\t\t\t.skip((pageCurrent - 1) * this.options.pageSize)\r\n\t\t\t\t\t.limit(this.options.pageSize)\r\n\t\t\t\t\t.get({\r\n\t\t\t\t\t\tgetCount: true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\tcount,\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = res.result\r\n\t\t\t\t\t\tfor (const item of data) {\r\n\t\t\t\t\t\t\tmapfields(this.fieldsMap, item, item)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.options.total = count\r\n\t\t\t\t\t\tthis.tableData = []\r\n\t\t\t\t\t\tthis.tableData = data\r\n\t\t\t\t\t}).catch((err) => {\r\n\t\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t\t\t// err.message 错误信息\r\n\t\t\t\t\t\t// err.code 错误码\r\n\t\t\t\t\t}).finally(() => {\r\n\t\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//获取渠道信息\r\n\t\t\tgetChannelData(appid, platform_id) {\r\n\t\t\t\tthis.query.channel_id = ''\r\n\t\t\t\tconst db = uniCloud.database()\r\n\t\t\t\tconst condition = {}\r\n\t\t\t\t//对应应用\r\n\t\t\t\tappid = appid ? appid : this.query.appid\r\n\t\t\t\tif (appid) {\r\n\t\t\t\t\tcondition.appid = appid\r\n\t\t\t\t}\r\n\t\t\t\t//对应平台\r\n\t\t\t\tplatform_id = platform_id ? platform_id : this.query.platform_id\r\n\t\t\t\tif (platform_id) {\r\n\t\t\t\t\tcondition.platform_id = platform_id\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet platformTemp = db.collection('uni-stat-app-platforms')\r\n\t\t\t\t\t.field('_id, name')\r\n\t\t\t\t\t.getTemp()\r\n\r\n\t\t\t\tlet channelTemp = db.collection('uni-stat-app-channels')\r\n\t\t\t\t\t.where(condition)\r\n\t\t\t\t\t.field('_id, channel_name, create_time, platform_id')\r\n\t\t\t\t\t.getTemp()\r\n\r\n\t\t\t\tdb.collection(channelTemp, platformTemp)\r\n\t\t\t\t\t.orderBy('platform_id', 'asc')\r\n\t\t\t\t\t.get()\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tlet data = res.result.data\r\n\t\t\t\t\t\tlet channels = []\r\n\t\t\t\t\t\tif (data.length > 0) {\r\n\t\t\t\t\t\t\tlet channelName\r\n\t\t\t\t\t\t\tfor (let i in data) {\r\n\t\t\t\t\t\t\t\tchannelName = data[i].channel_name ? data[i].channel_name : '默认'\r\n\t\t\t\t\t\t\t\tif (data[i].platform_id.length > 0) {\r\n\t\t\t\t\t\t\t\t\tchannelName = data[i].platform_id[0].name + '-' + channelName\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tchannels.push({\r\n\t\t\t\t\t\t\t\t\tvalue: data[i]._id,\r\n\t\t\t\t\t\t\t\t\ttext: channelName\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.channelData = channels\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((err) => {\r\n\t\t\t\t\t\tconsole.error(err)\r\n\t\t\t\t\t\t// err.message 错误信息\r\n\t\t\t\t\t\t// err.code 错误码\r\n\t\t\t\t\t}).finally(() => {})\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.flex {\r\n\t\tdisplay: flex;\r\n\t\tflex-wrap: wrap;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.label-text {\r\n\t\tfont-size: 14px;\r\n\t\tcolor: #666;\r\n\t\tmargin: auto 0;\r\n\t\tmargin-right: 5px;\r\n\t}\r\n\r\n\t.line-bottom {\r\n\t\tborder-bottom: 2px solid #eee;\r\n\t}\r\n\r\n\t.uni-stat-table-bg {\r\n\t\tbackground-color: #4e82d9;\r\n\t\tcolor: #fff;\r\n\t}\r\n</style>\r\n","import MiniProgramPage from 'E:/testProjects/WeChatProjects/testProject-2/燃气后台管理面板/pages/uni-stat/user/retention/retention.vue'\nwx.createPage(MiniProgramPage)"],"names":["fieldsFactory","stringifyQuery","debounce","getTimeOfSomeDayAgo","uniCloud","stringifyGroupField","formatDate","uni","mapfields"],"mappings":"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"}