{"version":3,"file":"fieldsMap.js","sources":["pages/uni-stat/device/retention/fieldsMap.js"],"sourcesContent":["/**\n * 页面上的数据都来自数据库，且多处 ui 消费，页面直接使用字段会造成耦合和冗余，固在此抽出来统一配置（clientdb 查询方法、概念文字提示等）和处理（对值再计算、格式化等）\n * title 显示所使用名称\r\n * field 数据库字段名\r\n * computed 计算表达式配置，只支持除法计算（需要 mapfield 函数支持，也可自行扩展）\r\n * tooltip 对字段解释的提示文字\n * formatter 数字格式化的配置，省缺为 ','\n  \t* '' 空字符串 则表示不格式化\n\t* ',' 数字格式，例：1000 格式为 1,000\n\t* '%' 百分比格式 例：0.1 格式为 10%\n\t* ':' 时分秒格式 例：90 格式为 00:01:30\n\t* '-' 日期格式 例：1655196831390(值需为时间戳) 格式为 2022-06-14\n * stat 对字段做 groupField 时需使用的数据库计算方法，省缺为 'sum'\n  \t* 'sum' 表示对字段做求和运算\n  \t* 'avg' 表示对字段做平均运算\n  \t* '-1' 表示不对字段做运算\n * fix 数字保留几位小数，>1 默认不保留小数，<1 默认保留两位小数\n * value 默认值 (仅用于 uni-stat-panel 组件) todo: 可移除\n * contrast 对比值 (仅用于 uni-stat-panel 组件) todo: 可移除\n */\n\nfunction fieldsFactory(maps = [{\r\n\ttitle: '新增设备',\r\n\tfield: 'new_device_count',\r\n\tstat: 0\r\n}]) {\r\n\tlet fieldsMap = [{\r\n\t\ttitle: '日期',\r\n\t\tfield: 'start_time',\r\n\t\ttooltip: '',\r\n\t\tformatter: '-',\n\t\tstat: -1\r\n\t}]\r\n\r\n\tif (maps) {\r\n\t\tfieldsMap.push(...maps)\r\n\t}\r\n\r\n\tconst values = [1, 2, 3, 4, 5, 6, 7, 14, 30]\r\n\tconst fields = values.map(val => {\r\n\t\treturn {\r\n\t\t\ttitle: `${val}天后`,\r\n\t\t\tfield: `d_${val}`,\n\t\t\tcomputed: `d_${val}/${maps[0].field}`,\r\n\t\t\tformatter: '%',\r\n\t\t\ttooltip: ''\r\n\t\t}\r\n\t})\r\n\r\n\tfieldsMap = fieldsMap.concat(fields)\r\n\r\n\treturn fieldsMap\r\n\r\n\r\n}\r\n\r\nexport default fieldsFactory\n"],"names":[],"mappings":";AAqBA,SAAS,cAAc,OAAO,CAAC;AAAA,EAC9B,OAAO;AAAA,EACP,OAAO;AAAA,EACP,MAAM;AACP,CAAC,GAAG;AACH,MAAI,YAAY,CAAC;AAAA,IAChB,OAAO;AAAA,IACP,OAAO;AAAA,IACP,SAAS;AAAA,IACT,WAAW;AAAA,IACX,MAAM;AAAA,EACR,CAAE;AAED,MAAI,MAAM;AACT,cAAU,KAAK,GAAG,IAAI;AAAA,EACtB;AAED,QAAM,SAAS,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,GAAG,IAAI,EAAE;AAC3C,QAAM,SAAS,OAAO,IAAI,SAAO;AAChC,WAAO;AAAA,MACN,OAAO,GAAG,GAAG;AAAA,MACb,OAAO,KAAK,GAAG;AAAA,MACf,UAAU,KAAK,GAAG,IAAI,KAAK,CAAC,EAAE,KAAK;AAAA,MACnC,WAAW;AAAA,MACX,SAAS;AAAA,IACT;AAAA,EACH,CAAE;AAED,cAAY,UAAU,OAAO,MAAM;AAEnC,SAAO;AAGR;;"}