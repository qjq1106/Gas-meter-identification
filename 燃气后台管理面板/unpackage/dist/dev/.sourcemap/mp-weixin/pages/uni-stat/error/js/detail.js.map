{"version":3,"file":"detail.js","sources":["pages/uni-stat/error/js/detail.vue","../../../../微信开发者工具/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNcdW5pLXN0YXRcZXJyb3JcanNcZGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"fix-top-window\">\r\n\t\t<view class=\"uni-container\">\r\n\t\t\t<uni-stat-table :data=\"tableData\" :filedsMap=\"popupFieldsMap\" :loading=\"loading\" />\r\n\t\t\t<view class=\"uni-pagination-box\">\r\n\t\t\t\t<uni-pagination show-icon show-page-size :page-size=\"options.pageSize\" :current=\"options.pageCurrent\"\r\n\t\t\t\t\t:total=\"options.total\" @change=\"changePageCurrent\" @pageSizeChange=\"changePageSize\" />\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- #ifndef H5 -->\r\n\t\t<fix-window />\r\n\t\t<!-- #endif -->\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tmapfields,\r\n\t\tstringifyQuery,\r\n\t\tgetTimeOfSomeDayAgo,\r\n\t\tdivision,\r\n\t\tformat,\r\n\t\tformatDate,\r\n\t\tparseDateTime,\r\n\t\tdebounce\r\n\t} from '@/js_sdk/uni-stat/util.js'\r\n\timport {\r\n\t\tpopupFieldsMap\r\n\t} from './fieldsMap.js'\r\n\r\n\tconst panelOption = [{\r\n\t\ttitle: '错误总数',\r\n\t\tvalue: 0,\r\n\t\ttooltip: '指应用在某个时间段内出现错误的总数'\r\n\t}, {\r\n\t\ttitle: '错误率',\r\n\t\tvalue: 0,\r\n\t\ttooltip: '时间范围内的总错误数/应用启动次数，如果小于0.01%，默认显示为0'\r\n\t}]\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpopupFieldsMap,\r\n\t\t\t\toptions: {\r\n\t\t\t\t\tpageSize: 20,\r\n\t\t\t\t\tpageCurrent: 1, // 当前页\r\n\t\t\t\t\ttotal: 0, // 数据总量\r\n\t\t\t\t},\r\n\t\t\t\tquery: {\r\n\t\t\t\t\terror_hash: '',\r\n\t\t\t\t\tcreate_time: []\r\n\t\t\t\t},\r\n\t\t\t\tloading: false,\r\n\t\t\t\ttableData: []\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(option) {\r\n\t\t\tlet {\r\n\t\t\t\terror_hash,\r\n\t\t\t\tcreate_time\r\n\t\t\t} = option\r\n\t\t\tif (error_hash) {\r\n\t\t\t\tcreate_time = Number(create_time)\r\n\t\t\t\tthis.query.error_hash = error_hash\r\n\t\t\t\tthis.query.create_time = [create_time, create_time + 24 * 60 * 60 * 1000]\r\n\t\t\t\tthis.getTableData(stringifyQuery(this.query))\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tchangePageCurrent(e) {\r\n\t\t\t\tthis.options.pageCurrent = e.current\r\n\t\t\t\tthis.getTableData(stringifyQuery(this.query))\r\n\t\t\t},\r\n\r\n\t\t\tchangePageSize(pageSize) {\r\n\t\t\t\tthis.options.pageSize = pageSize\r\n\t\t\t\tthis.options.pageCurrent = 1 // 重置分页\r\n\t\t\t\tthis.getTableData(stringifyQuery(this.query))\r\n\t\t\t},\r\n\r\n\r\n\t\t\tgetTableData(query) {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tpageCurrent\r\n\t\t\t\t} = this.options\r\n\t\t\t\tthis.loading = true\r\n\t\t\t\tconst db = uniCloud.database()\r\n\t\t\t\tdb.collection('uni-stat-error-logs')\r\n\t\t\t\t\t.where(query)\r\n\t\t\t\t\t.orderBy('create_time', 'desc')\r\n\t\t\t\t\t.skip((pageCurrent - 1) * this.options.pageSize)\r\n\t\t\t\t\t.limit(this.options.pageSize)\r\n\t\t\t\t\t.get({\r\n\t\t\t\t\t\tgetCount: true\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(res => {\r\n\t\t\t\t\t\tconst {\r\n\t\t\t\t\t\t\tcount,\r\n\t\t\t\t\t\t\tdata\r\n\t\t\t\t\t\t} = res.result\r\n\t\t\t\t\t\tthis.options.total = count\r\n\t\t\t\t\t\tfor (const item of data) {\r\n\t\t\t\t\t\t\titem.create_time = parseDateTime(item.create_time, 'dateTime')\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.tableData = data\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.finally(() => {\r\n\t\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t.uni-stat-panel {\r\n\t\tbox-shadow: unset;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\t\tpadding: 0;\r\n\t\tmargin: 0 15px;\r\n\t}\r\n</style>\n","import MiniProgramPage from 'E:/testProjects/WeChatProjects/testProject-2/燃气后台管理面板/pages/uni-stat/error/js/detail.vue'\nwx.createPage(MiniProgramPage)"],"names":["popupFieldsMap","stringifyQuery","uniCloud","parseDateTime"],"mappings":";;;;AAyCC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,gBAAAA,iCAAc;AAAA,MACd,SAAS;AAAA,QACR,UAAU;AAAA,QACV,aAAa;AAAA;AAAA,QACb,OAAO;AAAA;AAAA,MACP;AAAA,MACD,OAAO;AAAA,QACN,YAAY;AAAA,QACZ,aAAa,CAAC;AAAA,MACd;AAAA,MACD,SAAS;AAAA,MACT,WAAW,CAAC;AAAA,IACb;AAAA,EACA;AAAA,EACD,OAAO,QAAQ;AACd,QAAI;AAAA,MACH;AAAA,MACA;AAAA,IACD,IAAI;AACJ,QAAI,YAAY;AACf,oBAAc,OAAO,WAAW;AAChC,WAAK,MAAM,aAAa;AACxB,WAAK,MAAM,cAAc,CAAC,aAAa,cAAc,KAAK,KAAK,KAAK,GAAI;AACxE,WAAK,aAAaC,oBAAAA,eAAe,KAAK,KAAK,CAAC;AAAA,IAC7C;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,kBAAkB,GAAG;AACpB,WAAK,QAAQ,cAAc,EAAE;AAC7B,WAAK,aAAaA,oBAAAA,eAAe,KAAK,KAAK,CAAC;AAAA,IAC5C;AAAA,IAED,eAAe,UAAU;AACxB,WAAK,QAAQ,WAAW;AACxB,WAAK,QAAQ,cAAc;AAC3B,WAAK,aAAaA,oBAAAA,eAAe,KAAK,KAAK,CAAC;AAAA,IAC5C;AAAA,IAGD,aAAa,OAAO;AACnB,YAAM;AAAA,QACL;AAAA,MACC,IAAE,KAAK;AACT,WAAK,UAAU;AACf,YAAM,KAAKC,cAAQ,GAAC,SAAS;AAC7B,SAAG,WAAW,qBAAqB,EACjC,MAAM,KAAK,EACX,QAAQ,eAAe,MAAM,EAC7B,MAAM,cAAc,KAAK,KAAK,QAAQ,QAAQ,EAC9C,MAAM,KAAK,QAAQ,QAAQ,EAC3B,IAAI;AAAA,QACJ,UAAU;AAAA,OACV,EACA,KAAK,SAAO;AACZ,cAAM;AAAA,UACL;AAAA,UACA;AAAA,QACC,IAAE,IAAI;AACR,aAAK,QAAQ,QAAQ;AACrB,mBAAW,QAAQ,MAAM;AACxB,eAAK,cAAcC,oBAAAA,cAAc,KAAK,aAAa,UAAU;AAAA,QAC9D;AACA,aAAK,YAAY;AAAA,OACjB,EACA,QAAQ,MAAM;AACd,aAAK,UAAU;AAAA,OACf;AAAA,IACH;AAAA,EACD;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjHD,GAAG,WAAW,eAAe;"}